<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>æµªæ¼«äº’åŠ¨åŠ å¼ºç‰ˆ</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
    height:100vh;
    background:linear-gradient(135deg,#ffd6e7,#ffeaf4);
    overflow:hidden;
    font-family:'Comic Sans MS',cursive;
    animation: bgChange 8s ease-in-out infinite alternate;
}
@keyframes bgChange{
    0%{background:linear-gradient(135deg,#ffd6e7,#ffeaf4);}
    50%{background:linear-gradient(135deg,#ffeaf4,#fff0f6);}
    100%{background:linear-gradient(135deg,#fff0f6,#ffd6e7);}
}
/* é¡¶éƒ¨æ»‘åŠ¨æ–‡å­— */
@keyframes slideRight {0%{left:-100%;}100%{left:100%;}}
.top-slide-text{
    position:fixed;top:0;left:-100%;font-size:24px;
    font-weight:bold;color:#ff3366;animation:slideRight 12s linear infinite;
    z-index:10;white-space:nowrap;
}
.top-slide-text.second{animation-delay:4s;}

canvas#fireworks{
    position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;
}

.center-content{
    position:relative;z-index:2;height:100vh;
    display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;
}
h1{
    color:#ff6699;font-size:2em;font-weight:bold;
    text-shadow:0 0 8px rgba(255,255,255,0.8);
}
button{
    padding:10px 20px;margin:5px;border:none;border-radius:20px;
    background-color:#ff66b2;color:white;cursor:pointer;font-size:18px;
}
button:hover{transform:scale(1.05);box-shadow:0 0 15px #ff99cc;}
.envelope{
    width:150px;height:100px;position:relative;background:#ffcccc;
    cursor:pointer;margin-top:20px;transition:transform 0.5s;
}
.envelope::before{
      content:'';position:absolute;
    top:0;left:0;
    border-width:50px 75px 0 75px;
    border-style:solid;
    border-color:#ff9999 transparent transparent transparent;
    transition:transform 1s, border-color 0.5s;
    transform-origin:top;
}
.envelope.open::before
{transform:rotateX(180deg);}
.letter{
    position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
    width:60%;max-width:400px;background:rgba(255,255,255,0.9);
    padding:20px;border-radius:10px;z-index:100;
    white-space:pre-line;text-align:center;opacity:0;transition:opacity 1s;
}
.letter.show{opacity:1;}
.floating-name{
    position:fixed;font-weight:bold;white-space:nowrap;
    background:linear-gradient(to right,#ff0000,#ff9900,#ffff00);
    -webkit-background-clip:text;color:transparent;
    animation:arcFly linear forwards;
}
@keyframes arcFly{
    0%{transform:translate(100vw,0vh);}
    50%{transform:translate(50vw,-10vh);}
    100%{transform:translate(-20vw,0vh);}
}
.floating-text{
    position:fixed;color:#ff69b4;font-size:22px;
    animation:floatUp 4s linear forwards;
}
@keyframes floatUp{
    0%{transform:translateY(0);opacity:1;}
    100%{transform:translateY(-200px);opacity:0;}
}
.petal{position:absolute;background-size:contain;background-repeat:no-repeat;
    animation:fall linear infinite;z-index:1;pointer-events:none;}
@keyframes fall{
    0%{transform:translateY(-10vh) rotate(0deg);opacity:1;}
    100%{transform:translateY(110vh) rotate(720deg);opacity:0;}
}
.heart{
    position:absolute;background:linear-gradient(135deg, rgba(255,51,102,0.9), rgba(255,102,153,0.5));
    transform:rotate(45deg);animation:fall linear infinite;
    z-index:1;pointer-events:none;
}
.heart::before,.heart::after{
    content:'';position:absolute;width:100%;height:100%;
    background:linear-gradient(135deg, rgba(255,51,102,0.9), rgba(255,102,153,0.5));
    border-radius:50%;
}
.heart::before{top:-50%;left:0;}
.heart::after{left:-50%;top:0;}
#chatbox{
    position:fixed;bottom:20px;right:20px;background:rgba(255,255,255,0.8);
    padding:10px;border-radius:8px;z-index:10;
}
#chatbox input{padding:5px;width:150px;}
#popup{opacity:0;transition:opacity 1s;margin-top:20px;}
#popup.show{opacity:1;}

/* å…‰æ ‡åŠ¨ç”» */
.cursor {
    display: inline-block;
    width: 2px;
    background-color: #ff3366;
    margin-left: 2px;
}
.blink {
    animation: blinkCursor 0.8s steps(1) infinite;
}
@keyframes blinkCursor {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
}

/* å¼¹çª—æ•´ä½“å®¹å™¨ */
#popup {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: none; /* é»˜è®¤éšè— */
    z-index: 1000;
}

/* åŠé€æ˜èƒŒæ™¯é®ç½© */
.popup-bg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.4);
    backdrop-filter: blur(4px); /* å¯é€‰ï¼šèƒŒæ™¯æ¨¡ç³Š */
    cursor: pointer;
}

/* å¼¹å‡ºçš„å›¾ç‰‡å†…å®¹ */
.popup-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.8);
    opacity: 0;
    transition: transform 0.8s ease-out, opacity 0.8s ease-out;
}

#popup.show .popup-content {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
}

#popup-img {
    max-width: 80vw;
    max-height: 80vh;
    border-radius: 15px;
    box-shadow: 0 0 25px rgba(255,102,153,0.8);
}
#popup.show-bg .popup-bg { opacity:1; }

</style>
</head>
<body>

<canvas id="fireworks"></canvas>
<div class="top-slide-text">â¤ æ°¸è¿œçˆ±ä½  â¤ ä½™ç”Ÿè¯·å¤šæŒ‡æ•™ â¤ é‡è§ä½ æ˜¯æˆ‘æœ€ç¾çš„æ•…äº‹ â¤</div>
<div class="top-slide-text second">â¤ æ°¸è¿œçˆ±ä½  â¤ ä½™ç”Ÿè¯·å¤šæŒ‡æ•™ â¤ é‡è§ä½ æ˜¯æˆ‘æœ€ç¾çš„æ•…äº‹ â¤</div>

<div class="center-content">
    <h1>ğŸŒ¸ é‡è§ä½ æ˜¯æˆ‘æœ€ç¾çš„æ•…äº‹ ğŸŒ¸</h1>
    <button onclick="showImage()">ç‚¹æˆ‘çœ‹çœ‹</button>
    <!-- æ‚¬æµ®å¼¹çª—ï¼ˆé»˜è®¤éšè—ï¼‰ -->
<div id="popup">
    <div class="popup-bg" onclick="closeImage()"></div>
    <div class="popup-content">
        <img id="popup-img" src="jpg/2.jpg" alt="ç”œèœœç¬é—´">
    </div>
</div>
    <div class="envelope" onclick="openEnvelope()" title="ç‚¹å‡»æ”¶ä¿¡"></div>
</div>

<div class="letter" id="letterContent"></div>

<div id="chatbox">
    <input id="message" placeholder="å†™ä¸€å¥è¯...">
    <button onclick="sendMessage()">å‘é€</button>
</div>

<script>
// åŸºç¡€æ•ˆæœ
for(let i=0;i<50;i++){createHeart();}
setInterval(createHeart,500);

function showImage(){
    popup.style.display = 'block';

    // èƒŒæ™¯å…ˆå‡ºç°
    popup.classList.add('show-bg');

    // å»¶è¿Ÿå›¾ç‰‡å¼¹å‡º
    setTimeout(() => {
        popup.classList.add('show');
        triggerHeartExplosion();
        launchFirework(window.innerWidth / 2, window.innerHeight / 2, true);
    }, 200);

}
function createFloatingName(){
    const name=document.createElement('div');
    name.className='floating-name';
    name.textContent="æ®·å›æ€¡";
    name.style.fontSize=(22+Math.random()*12)+"px";
    name.style.top=(Math.random()*90)+"vh";
    name.style.animationDuration=(5+Math.random()*3)+'s';
    document.body.appendChild(name);
    setTimeout(()=>name.remove(),8000);
}
const quotes=["ä¸€è§å¦‚æ•…","ä½™ç”Ÿè¯·å¤šæŒ‡æ•™","ä½ æ˜¯æˆ‘å”¯ä¸€","æ°¸è¿œçˆ±ä½ ","æ˜Ÿæ²³ä¸åŠä½ "];
function createQuote(){
    const text=document.createElement('div');
    text.className='floating-text';
    text.textContent=quotes[Math.floor(Math.random()*quotes.length)];
    text.style.left=Math.random()*80+"vw";
    text.style.top=(Math.random()*80)+"vh";
    document.body.appendChild(text);
    setTimeout(()=>text.remove(),4000);
}
function sendMessage(){
    const val=document.getElementById('message').value.trim();
    if(!val) return;
    const text=document.createElement('div');
    text.className='floating-text';
    text.textContent=val;
    text.style.left="50vw";
    text.style.top="80vh";
    document.body.appendChild(text);
    setTimeout(()=>text.remove(),4000);
    launchFirework(window.innerWidth/2, window.innerHeight/2, true);
    triggerHeartExplosion();
    document.getElementById('message').value="";
}
function createPetal(){
    const petal=document.createElement('div');
    petal.className='petal';
    petal.style.backgroundImage="url('https://upload.wikimedia.org/wikipedia/commons/3/3b/Sakura_flower_icon.svg')";
    const size=10+Math.random()*15;
    petal.style.width=size+"px";petal.style.height=size+"px";
    petal.style.left=Math.random()*100+'vw';
    petal.style.top='-10vh';
    petal.style.animationDuration=(3+Math.random()*4)+'s';
    document.body.appendChild(petal);
    setTimeout(()=>petal.remove(),8000);
}
function createHeart(){
    const heart=document.createElement('div');
    heart.className='heart';
    const size=20+Math.random()*20;
    heart.style.width=size+"px";heart.style.height=size+"px";
    heart.style.left=Math.random()*100+'vw';
    heart.style.top='-10vh';
    heart.style.animationDuration=(4+Math.random()*3)+'s';
    document.body.appendChild(heart);
    setTimeout(()=>heart.remove(),7000);
}
function triggerHeartExplosion(){
    for(let i=0;i<50;i++){createHeart();}
}

// ä¿¡å°ç‚¹å‡»åˆ‡æ¢æ”¶ä¿¡ / å…³ä¿¡ï¼ˆä¿®æ”¹ç‰ˆï¼šå¸¦é—ªçƒå…‰æ ‡ + éšæœºé€Ÿåº¦æ‰“å­—æœºï¼‰
let envelopeOpen=false;
// é¢„åŠ è½½è½»å¾®é”®ç›˜éŸ³æ•ˆï¼ˆä½ å¯ä»¥æ¢æˆè‡ªå·±çš„éŸ³é¢‘æ–‡ä»¶è·¯å¾„ï¼‰
const typeSound = new Audio('');
typeSound.volume = 0.2; // è°ƒå°éŸ³é‡ï¼ŒæŸ”å’Œä¸€äº›

function openEnvelope() {
    const envelope = document.querySelector('.envelope');
    const letter = document.getElementById('letterContent');

    if (!envelopeOpen) {
        envelope.classList.add('open');
        letter.classList.add('show');

        const text = "äº²çˆ±çš„å›æ€¡å®å® â¤ï¸\nä½ æ˜¯æˆ‘ä¸€ç”Ÿæœ€ç¾çš„é‡è§ã€‚\næ„¿æˆ‘ä»¬æ—¶å…‰ä¸è€ï¼Œæˆ‘ä»¬ä¸æ•£ã€‚çº¸çŸ­æƒ…é•¿ï¼Œå†™ä¸å°½å¿ƒä¸­ä¸‡åƒã€‚å”¯æ„¿ç”¨ä½™ç”Ÿï¼Œä¸€å­—ä¸€å¥è¯´ç»™ä½ å¬ã€‚\n";
        letter.innerHTML = "<span id='typeText'></span><span class='cursor'></span>";
        const typeTextEl = document.getElementById('typeText');
        const cursorEl = document.querySelector('.cursor');

        let index = 0;

        // æ‰“å­—å‡½æ•°
        function typeWriter() {
            if (index < text.length) {
                typeTextEl.innerHTML += text.charAt(index);

                // ç©ºæ ¼æˆ–å›è½¦ä¸å‘å£°ï¼Œå…¶ä»–å­—ç¬¦å‘é”®ç›˜éŸ³
                if (text.charAt(index).trim() !== "") {
                    const soundClone = typeSound.cloneNode();
                    soundClone.play().catch(() => {});
                }

                index++;
                // éšæœºé€Ÿåº¦ 80~160ms
                setTimeout(typeWriter, 80 + Math.random() * 80);
            } else {
                // æ‰“å®Œå 1 ç§’å†è§¦å‘çˆ±å¿ƒå’ŒçƒŸèŠ±
                cursorEl.classList.add('blink');
                setTimeout(() => {
                    triggerHeartExplosion();
                    launchFirework(window.innerWidth / 2, window.innerHeight / 2, true);
                }, 1000);
            }
        }

        // å‰§æƒ…èŠ‚å¥ï¼šä¿¡å°ç¿»ç›–å 0.5s å¼€å§‹æ‰“å­—
        setTimeout(() => {
            typeWriter();
        }, 500);

        envelopeOpen = true;
    } else {
        envelope.classList.remove('open');
        letter.classList.remove('show');
        letter.innerHTML = "";
        envelopeOpen = false;
    }
}
function heartPathAnimation(){
    const centerX=window.innerWidth/2;
    const centerY=window.innerHeight/2;
    let t=0;
    const interval=setInterval(()=>{
        const x=centerX+80*Math.pow(Math.sin(t),3);
        const y=centerY-(60*Math.cos(t)-30*Math.cos(2*t)-20*Math.cos(3*t)-10*Math.cos(4*t));
        const heart=document.createElement('div');
        heart.className='heart';
        heart.style.width="20px";heart.style.height="20px";
        heart.style.left=x+"px";heart.style.top=y+"px";
        document.body.appendChild(heart);
        setTimeout(()=>heart.remove(),3000);
        t+=Math.PI/32;
        if(t>Math.PI*2) clearInterval(interval);
    },50);
}

// çƒŸèŠ±åŠ¨ç”»
const canvas=document.getElementById('fireworks');
const ctx=canvas.getContext('2d');
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;
let particles=[];
function launchFirework(x,y,drawLines=false){
    let points=[];
    for(let i=0;i<50;i++){
        const angle=(i*Math.PI*2)/50;
        const speed=Math.random()*4;
        const vx=Math.cos(angle)*speed;
        const vy=Math.sin(angle)*speed;
        particles.push({x,y,vx,vy,alpha:1,color:`hsl(${Math.random()*360},100%,60%)`});
        if(drawLines) points.push({x:x+vx*20,y:y+vy*20});
    }
    if(drawLines){
        setTimeout(()=>{
            ctx.strokeStyle="rgba(255,255,255,0.7)";
            ctx.beginPath();
            points.forEach((p,idx)=>{
                if(idx===0) ctx.moveTo(p.x,p.y); else ctx.lineTo(p.x,p.y);
            });
            ctx.closePath();ctx.stroke();
        },800);
    }
}
function animate(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    particles.forEach((p,i)=>{
        p.x+=p.vx;p.y+=p.vy;
        p.alpha-=0.02;
        if(p.alpha<=0) particles.splice(i,1);
        ctx.globalAlpha=p.alpha;
        ctx.fillStyle=p.color;
        ctx.beginPath();
        ctx.arc(p.x,p.y,3,0,Math.PI*2);
        ctx.fill();
    });
    requestAnimationFrame(animate);
}
animate();

setInterval(createPetal,150);
setInterval(createFloatingName,600);
setInterval(createQuote,4000);

document.addEventListener('click', e=>{
    launchFirework(e.clientX,e.clientY,true);
    triggerHeartExplosion();
});

// å¼¹å‡ºå›¾ç‰‡
function showImage() {
    const popup = document.getElementById('popup');
    popup.style.display = 'block';
    setTimeout(() => popup.classList.add('show'), 10); // è§¦å‘åŠ¨ç”»

    // ä¼´éšæ•ˆæœ
    triggerHeartExplosion();
    launchFirework(window.innerWidth/2, window.innerHeight/2, true);
}

// å…³é—­å›¾ç‰‡
function closeImage() {
    const popup = document.getElementById('popup');
    popup.classList.remove('show');
    setTimeout(() => popup.style.display = 'none', 800); // ç­‰åŠ¨ç”»ç»“æŸå†éšè—
}

// å¯é€‰ï¼šæŒ‰ ESC é”®å…³é—­å¼¹çª—
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') closeImage();
});
document.getElementById('popup-img').addEventListener('click', () => {
    triggerHeartExplosion();
    launchFirework(window.innerWidth / 2, window.innerHeight / 2, true);
});
const words = [
    "é‡è§ä½ æ˜¯æˆ‘æœ€ç¾çš„å¥‡é‡ğŸ’–",
    "æ¯æ¬¡çœ‹ä½ éƒ½è§‰å¾—å¾ˆå¹¸ç¦ğŸŒ¸",
    "ä½ æ˜¯æˆ‘çœ¼é‡Œæœ€äº®çš„æ˜Ÿâœ¨"
];
document.querySelector('.popup-content').insertAdjacentHTML(
    'beforeend',
    `<p style="text-align:center;color:#fff;margin-top:15px;font-size:18px;">
        ${words[Math.floor(Math.random()*words.length)]}
    </p>`
);

</script>
</body>
</html>
